@model Eprocurement.Compras.Models.ProveedorRegistro

@{
    ViewBag.Title = "Aceptar proveedor";
}
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">
<form action="/Home/Index" method="post" class="registro-form form-horizontal" id="form_fact" name="form_fact">
    @Html.AntiForgeryToken()
    <div class="row">
        <div class="col-sm-12 t-a-c">
            <h1>
                Portal de proveedores
            </h1>
        </div>

    </div>
    <div class="row">
        <div class="col-sm-12 ">
            <h3>
                Validación de datos
            </h3>
        </div>

    </div>
    <div class="row">
        <div class="col-md-12">
            <div class="card mt-5">
                <div class="card-header bg-purple">

                    Detalles de la compañía

                    @*<span class="pull-right clickable"><i class="glyphicon glyphicon-chevron-up"></i></span>*@
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="form-group col-md-6">
                            @Html.Label("empresa", "Nombre de la empresa", new { @class = "col-md-4 control-label" })
                            <div class="col-md-8">
                                @Html.TextBoxFor(model => model.NombreEmpresa, new { @class = "form-control" })
                            </div>
                        </div>
                        <div class="form-group col-md-6">
                            @Html.Label("razonSocial", "Razón social", new { @class = "col-md-4 control-label" })
                            <div class="col-md-8">
                                @Html.TextBoxFor(model => model.RazonSocial, new { @class = "form-control" })
                            </div>
                        </div>
                        <div class="form-group col-md-6">
                            @Html.Label("rfc", "RFC", new { @class = "col-md-4 control-label" })
                            <div class="col-md-8">
                                @Html.TextBoxFor(model => model.RFC, new { @class = "form-control" })
                            </div>
                        </div>
                        <div class="form-group col-md-6">
                            @Html.Label("nif", "NIF", new { @class = "col-md-4 control-label" })
                            <div class="col-md-8">
                                @Html.TextBoxFor(model => model.NIF, new { @class = "form-control" })
                            </div>
                        </div>
                        <div class="form-group col-md-6">
                            @Html.Label("telefono", "Teléfono", new { @class = "col-md-4 control-label" })
                            <div class="col-md-8">
                                @Html.TextBoxFor(model => model.ProvTelefono, new { @class = "form-control" })
                            </div>
                        </div>
                        <div class="form-group col-md-6">
                            @Html.Label("fax", "Fax", new { @class = "col-md-4 control-label" })
                            <div class="col-md-8">
                                @Html.TextBoxFor(model => model.ProvFax, new { @class = "form-control" })
                            </div>
                        </div>
                        <div class="form-group col-md-6">
                            @Html.Label("paginaWeb", "Página web", new { @class = "col-md-4 control-label" })
                            <div class="col-md-8">
                                @Html.TextBoxFor(model => model.PaginaWeb, new { @class = "form-control" })
                            </div>
                        </div>
                        <div class="form-group col-md-6">
                            @Html.Label("zonaHoraria", "Zona horaria", new { @class = "col-md-4 control-label" })
                            <div class="col-md-8">
                                @Html.DropDownListFor(model => model.IdZonaHoraria, new SelectList(ViewBag.ZonaHorariaList, "IdZonaHoraria", "Nombre"), "...", new { @class = "form-control" })
                            </div>
                        </div>
                        <div class="form-group col-md-6">
                            @Html.Label("tipoProveedor", "Tipo proveedor", new { @class = "col-md-4 control-label" })
                            <div class="col-md-8">
                                @Html.DropDownListFor(model => model.IdTipoProveedor, new SelectList(ViewBag.TipoProveedorList, "IdTipoProveedor", "Tipo"), "...", new { @class = "form-control" })
                            </div>
                        </div>
                        <div class="form-group col-md-6">
                            @Html.Label("axNumeroProveedor", "Número AX", new { @class = "col-md-4 control-label" })
                            <div class="col-md-8">
                                @Html.TextBoxFor(model => model.AXNumeroProveedor, new { @class = "form-control" })
                            </div>
                        </div>
                        <div class="form-group col-md-6">
                            @Html.Label("nacionalidad", "Nacionalidad", new { @class = "col-md-4 control-label" })
                            <div class="col-md-8">
                                @Html.DropDownListFor(model => model.IdNacionalidad, new SelectList(ViewBag.NacionalidadList, "IdNacionalidad", "Nombre"), "...", new { @class = "form-control" })
                            </div>
                        </div>
                        <div class="form-group col-md-6">
                            @Html.Label("codigo", "Código postal", new { @class = "col-md-4 control-label" })
                            <div class="col-md-8">
                                @Html.TextBoxFor(model => model.Direccion.CodigoPostal, new { @class = "form-control" })
                            </div>
                        </div>
                        <div class="form-group col-md-6">
                            @Html.Label("colonia", "Colonia", new { @class = "col-md-4 control-label" })
                            <div class="col-md-8">
                                @Html.TextBoxFor(model => model.Direccion.Colonia, new { @class = "form-control" })
                            </div>
                        </div>
                        <div class="form-group col-md-6">
                            @Html.Label("direccion", "Calle", new { @class = "col-md-4 control-label" })
                            <div class="col-md-8">
                                @Html.TextBoxFor(model => model.Direccion.Calle, new { @class = "form-control" })
                            </div>
                        </div>
                        <div class="form-group col-md-6">
                            @Html.Label("pais", "País", new { @class = "col-md-4 control-label" })
                            <div class="col-md-8">
                                @Html.DropDownListFor(model => model.Direccion.IdPais, new SelectList(ViewBag.PaisList, "IdPais", "Nombre"), "...", new { @class = "form-control", @id = "PaisProveedor" })
                            </div>
                        </div>
                        <div class="form-group col-md-6">
                            @Html.Label("estado", "Estado", new { @class = "col-md-4 control-label" })
                            <div class="col-md-8">
                                @Html.DropDownListFor(model => model.Direccion.IdEstado, new SelectList(Enumerable.Empty<EPROCUREMENT.GAPPROVEEDOR.Entities.EstadoDTO>(), "IdEstado", "Nombre"), "...", new { @class = "form-control", @id = "EstadoProveedor" })
                            </div>
                        </div>
                        <div class="form-group col-md-6">
                            @Html.Label("municipio", "Municipio", new { @class = "col-md-4 control-label" })
                            <div class="col-md-8">
                                @Html.DropDownListFor(model => model.Direccion.IdMunicipio, new SelectList(Enumerable.Empty<EPROCUREMENT.GAPPROVEEDOR.Entities.MunicipioDTO>(), "idMunicipio", "Nombre"), "...", new { @class = "form-control", @id = "MunicipioProveedor" })
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-12">
            <div class="card mt-5">
                <div class="card-header bg-purple">

                    Detalles del contacto

                    @*<span class="pull-right clickable"><i class="glyphicon glyphicon-chevron-up"></i></span>*@
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="form-group col-md-12 ">
                            @Html.Label("contacto", "Contacto", new { @class = "col-md-2 control-label" })
                            <div class="col-md-10">
                                @Html.TextBoxFor(model => model.Contacto.NombreContacto, new { @class = "form-control" })
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-md-6">
                            @Html.Label("cargo", "Cargo", new { @class = "col-md-4 control-label" })
                            <div class="col-md-8">
                                @Html.TextBoxFor(model => model.Contacto.Cargo, new { @class = "form-control" })
                            </div>
                        </div>
                        <div class="form-group col-md-6">
                            @Html.Label("nacionalidad", "Nacionalidad", new { @class = "col-md-4 control-label" })
                            <div class="col-md-8">
                                @Html.DropDownListFor(model => model.Contacto.IdNacionalidad, new SelectList(ViewBag.NacionalidadList, "IdNacionalidad", "Nombre"), "...", new { @class = "form-control" })
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-md-6">
                            @Html.Label("teledonoDirecto", "Número de teléfono", new { @class = "col-md-4 control-label" })
                            <div class="col-md-8">
                                @Html.TextBoxFor(model => model.Contacto.TelefonoDirecto, new { @class = "form-control" })
                            </div>
                        </div>
                        <div class="form-group col-md-6">
                            @Html.Label("movil", "Número de celular", new { @class = "col-md-4 control-label" })
                            <div class="col-md-8">
                                @Html.TextBoxFor(model => model.Contacto.TelefonoMovil, new { @class = "form-control" })
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-md-6">
                            @Html.Label("fax", "Fax", new { @class = "col-md-4 control-label" })
                            <div class="col-md-8">
                                @Html.TextBoxFor(model => model.Contacto.Fax, new { @class = "form-control" })
                            </div>
                        </div>
                        <div class="form-group col-md-6">
                            @Html.Label("emailContacto", "Email", new { @class = "col-md-4 control-label" })
                            <div class="col-md-8">
                                @Html.TextBoxFor(model => model.Contacto.Email, new { @class = "form-control" })
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-md-6">
                            @Html.Label("paisContacto", "País", new { @class = "col-md-4 control-label" })
                            <div class="col-md-8">
                                @Html.DropDownListFor(model => model.Contacto.IdPais, new SelectList(ViewBag.PaisList, "IdPais", "Nombre"), "...", new { @class = "form-control" })

                            </div>
                        </div>
                        <div class="form-group col-md-6">
                            @Html.Label("zonaHorariaConctacto", "Zona horaria", new { @class = "col-md-4 control-label" })
                            <div class="col-md-8">
                                @Html.DropDownListFor(model => model.Contacto.IdZonaHoraria, new SelectList(ViewBag.ZonaHorariaList, "IdZonaHoraria", "Nombre"), "...", new { @class = "form-control" })
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-md-12 ">

                            @Html.Label("idioma", "Idioma", new { @class = "col-md-2 control-label" })
                            <div class="col-md-10">
                                @Html.DropDownListFor(model => model.Contacto.IdIdioma, new SelectList(ViewBag.IdiomaList, "IdIdioma", "NombreIdioma"), "...", new { @class = "form-control" })
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <div class="card mt-5">
                <div class="card-header bg-purple">

                    Especialidades de la empresa

                    @*<span class="pull-right clickable"><i class="glyphicon glyphicon-chevron-up"></i></span>*@
                </div>
                <div class="card-body">

                    @Html.Label("", "Marque los Aeropuertos que puede atender*", new { @class = "control-label m-b-1" })


                    <ul id="wkslist" class="ulChk">
                        @for (int idx = 0; idx < Model.AeropuertoList.Count; idx++)
                        {
                            @Html.HiddenFor(model => model.AeropuertoList[idx].Id)
                            @Html.HiddenFor(model => model.AeropuertoList[idx].Nombre)
                            <li class="col-sm-6">
                                @Html.CheckBoxFor(model => model.AeropuertoList[idx].Checado)
                                @Html.DisplayTextFor(model => model.AeropuertoList[idx].Nombre)
                            </li>
                        }
                    </ul>

                    @Html.Label("", "Favor de seleccionar el (los) giro (s) específicos que su empresa esta calificada (Máximo 5)*", new { @class = "control-label m-b-1 m-t-1" })

                    @for (int idx = 0; idx < 5; idx++)
                    {
                        @Html.HiddenFor(model => model.ProveedorGiroList[idx].IdProveedorGiro)
                        <div class="form-group col-md-12 sel-p">
                            @Html.Label("Giro1:", new { @class = "col-md-2 control-label" })
                            <div class="col-md-10">
                                @Html.DropDownListFor(x => x.ProveedorGiroList[idx].IdCatalogoGiro, new SelectList(ViewBag.GiroList, "IdGiro", "GiroNombre"), "...", new { @class = "form-control" })
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-sm-3">
            <button class="btnStyle" type="submit">Documentacion pendiente</button>
        </div>
        <div class="col-sm-3">
            <input type="button" class="btnStyle" data-toggle="modal" data-target="#modalRechazar" value="Rechazar" />
        </div>
        <div class="col-sm-3">
            <button class="btnStyle" type="submit">Cancelar</button>
        </div>
        <div class="col-sm-3">
            <button class="btnStyle" type="submit">Guardar</button>
        </div>
    </div>



    <!-- Modal -->
    <div class="modal fade" id="modalRechazar" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLongTitle">Motivo del rechazo</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-sm-12">
                            <label for="observaciones" class="col-form-label">Ingresa un comentario para el proveedor</label>
                            <textarea class="form-control" id="observaciones"></textarea>

                        </div>



                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                    <button type="button" id="btnRechazar" class="btn btn-primary"><i class='fas fa-paper-plane'></i>Enviar</button>
                </div>
            </div>
        </div>
    </div>
</form>

<script type="text/javascript">
    $(document).ready(function () {
        $("#PaisProveedor").change(function () {
            var dID = $('#PaisProveedor option:selected').val();
            $.getJSON("/Home/GetEstados", { idPais: dID },
                function (data) {
                    var select = $("#EstadoProveedor");
                    var selectMunicipio = $("#MunicipioProveedor");
                    select.empty();
                    selectMunicipio.empty();
                    select.append($('<option/>', {
                        value: 0,
                        text: "..."
                    }));
                    selectMunicipio.append($('<option/>', {
                        value: 0,
                        text: "..."
                    }));
                    $.each(data, function (index, itemData) {
                        select.append($('<option/>', {
                            value: itemData.IdEstado,
                            text: itemData.Nombre
                        }));
                    });
                });
        });

        $("#EstadoProveedor").change(function () {
            var dID = $('#EstadoProveedor option:selected').val();
            $.getJSON("/Home/GetMunicipios", { idEstado: dID },
                function (data) {
                    var select = $("#MunicipioProveedor");
                    select.empty();
                    select.append($('<option/>', {
                        value: 0,
                        text: "..."
                    }));
                    $.each(data, function (index, itemData) {
                        select.append($('<option/>', {
                            value: itemData.IdMunicipio,
                            text: itemData.Nombre
                        }));
                    });
                });
        });

        $("#btnRechazar").click(function () {

            swal({
                title: "¿Esta seguro de rechazar el proveedor?",
                //text: "Once deleted, you will not be able to recover this imaginary file!",
                icon: "warning",
                buttons: {
                    cancel: "Cancelar",
                    defeat: true,
                },
                dangerMode: true,
            })
                .then((willDelete) => {
                    if (willDelete) {
                        $('#modalRechazar').modal('hide');
                        swal("Poof! Your imaginary file has been deleted!", {
                            icon: "success",
                        });
                    }
                    //else {
                    //    swal("Your imaginary file is safe!");
                    //}
                });

        });
    });
</script>
